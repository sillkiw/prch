<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Прогнозирование нагрузки на экстренные службы · курсовая работа</title>

    <!-- reveal.js core styles (light theme) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.4.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.4.0/theme/white.min.css" id="theme">

    <!-- fonts, icons, KaTeX -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" crossorigin="anonymous">

    <style>
        /* Строгое академическое оформление, белый фон, синие акценты */
        body {
            background: #ffffff;
            font-family: 'Inter', Arial, sans-serif;
        }
        .reveal {
            background: #ffffff;
            color: #1e293b;
            font-family: 'Inter', Arial, sans-serif;
            font-size: 32px;
            font-weight: 400;
            line-height: 1.5;
        }
        .reveal h1, .reveal h2, .reveal h3, .reveal h4 {
            font-family: 'Inter', Arial, sans-serif;
            font-weight: 700;
            letter-spacing: -0.02em;
            text-transform: none;
            color: #000000;
        }
        .reveal h1 { font-size: 2.2em; margin-bottom: 0.5em; }
        .reveal h2 { font-size: 1.6em; color: #1e293b; }
        .reveal h3 { font-size: 1.2em; color: #2563eb; font-weight: 600; }
        .reveal .accent { color: #2563eb; font-weight: 600; }

        /* карточки для выделения информации */
        .card {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            padding: 0.8em 1.2em;
            box-shadow: 0 4px 8px rgba(0,0,0,0.02), 0 2px 4px rgba(0,0,0,0.02);
            margin: 0.5em 0;
        }
        .card-title {
            font-weight: 600;
            color: #0a101b;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 0.3em;
            margin-bottom: 0.5em;
        }

        /* таблицы */
        .reveal table {
            font-size: 0.7em;
            border-collapse: collapse;
            width: 100%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .reveal table th {
            background: #f8fafc;
            font-weight: 600;
            color: #2563eb;
            border-bottom: 2px solid #2563eb;
        }
        .reveal table td, .reveal table th {
            border: 1px solid #e2e8f0;
            padding: 0.5em;
            text-align: center;
        }

        /* плейсхолдеры SVG */
        .svg-placeholder {
            background: #f9f9f9;
            border: 1px dashed #94a3b8;
            border-radius: 16px;
            padding: 1.2em 0.8em 0.8em 0.8em;
            margin: 1em 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }
        .svg-placeholder svg {
            width: 100%;
            height: auto;
            max-height: 280px;
            display: block;
            margin: 0 auto;
        }
        .figcaption {
            font-size: 0.55em;
            color: #475569;
            text-align: center;
            margin-top: 0.5em;
            font-style: italic;
        }

        /* списки */
        .reveal ul {
            list-style-type: none;
        }
        .reveal ul li::before {
            content: "–";
            color: #2563eb;
            font-weight: 700;
            display: inline-block;
            width: 1.5em;
            margin-left: -1.5em;
        }

        /* колонки для литературы */
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2em;
            font-size: 0.6em;
            text-align: left;
        }
        .two-columns ul { list-style: none; padding: 0; }
        .two-columns li { margin-bottom: 0.5em; }
        .two-columns li::before { content: "—"; color: #2563eb; margin-right: 0.5em; }

        /* нижний колонтитул */
        .footer-note {
            position: absolute;
            bottom: 12px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 0.4em;
            color: #94a3b8;
            pointer-events: none;
        }

        /* фрагменты появления */
        .reveal .fragment { will-change: opacity, transform; }

        /* мелкий текст */
        .small { font-size: 0.65em; color: #475569; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
             <!-- ============================================== -->
            <!-- 1. Титульный слайд                             -->
            <!-- ============================================== -->
            <section>
                <h1 style="font-size: 2.5em; line-height: 1.3;">Прогнозирование числа вызовов экстренных служб</h1>
                <h2 style="color:#2563eb; margin-top: 0.2em;">Курсовая работа по дисциплине <br> «Методы анализа данных»</h2>
                <div style="margin-top: 2em;">
                 <center><p></i>Коваленко Анатолий, группа ПМ-2201</p> </center>   
                </div>
                <center><p style="margin-top: 2.5em; font-size: 0.8em;">2026</p></center>
                
               
            </section>

            <!-- ============================================== -->
            <!-- 2. Введение (2 слайда)                         -->
            <!-- ============================================== -->
                <section>
                    <div class="card" style="text-align: left;">
                        <div class="card-title">Исходные данные</div>
                        <ul>
                            <li>Сетка квадратов ~500×500 м — <strong>22 172 зоны</strong></li>
                            <li>Для западной части (<span class="accent">train</span>, 13 699 зон) известна средняя интенсивность вызовов <em>calls_daily</em> за сентябрь–декабрь 2017</li>
                            <li>Агрегация по будням/выходным и дням недели (calls_workday, calls_weekend, calls_wd0–wd6)</li>
                        </ul>
                    </div>
                    <div class="card fragment" style="text-align: left; margin-top: 0.3em;">
                        <div class="card-title">Цели</div>
                        <ul>
                            <li>Выявить закономерности пространственно-временного распределения</li>
                            <li>Построить информативные признаки (геометрия, инфраструктура)</li>
                            <li>Разработать модель прогноза нагрузки для планирования ресурсов экстренных служб</li>
                        </ul>
                    </div>
                </section>
      
<section style="display: flex; flex-direction: column; align-items: center;">
    <h3 style="text-align: center;">Данные: структура</h3>
    <div style="display: flex; align-items: stretch; gap: 2rem; margin-top: 1rem; justify-content: center; width: 100%;">
        <!-- Левая часть – изображение с фиксированной шириной 60% -->
        <div style="width: 60%; max-width: 600px; display: flex; align-items: center;">
            <img src="data.png" alt="Карта расположения квадратов train/test" 
                 style="width: 100%; height: auto; border-radius: 16px; box-shadow: 0 8px 16px rgba(0,0,0,0.05); border: 1px solid #e2e8f0;">
        </div>
        <!-- Правая часть – карточки фиксированной ширины -->
        <div style="width: 280px; display: flex; flex-direction: column; justify-content: center; gap: 1.2rem;">
            <div class="card" style="text-align: center; padding: 1rem 0.5rem;">
                <div class="card-title" style="font-size: 1.2rem;">Обучающая (запад)</div>
                <p style="font-size: 2.8rem; font-weight: 700; color: #2563eb; margin: 0.2rem 0; line-height: 1.2;">13 699</p>
                <p style="font-size: 0.9rem; color: #475569;">квадратов с известной интенсивностью</p>
            </div>
            <div class="card" style="text-align: center; padding: 1rem 0.5rem;">
                <div class="card-title" style="font-size: 1.2rem;">Тестовая (восток)</div>
                <p style="font-size: 2.8rem; font-weight: 700; color: #64748b; margin: 0.2rem 0; line-height: 1.2;">8 473</p>
                <p style="font-size: 0.9rem; color: #475569;">квадратов без целевой переменной</p>
            </div>
        </div>
    </div>
    <p class="figcaption" style="margin-top: 1.5rem; text-align: center;">Рис. 1 – Пространственное разделение данных: синий – train, серый – test</p>
</section>
         
            <!-- ============================================== -->
            <!-- 3. EDA – распределение calls_daily              -->
            <!-- ============================================== -->
            
                <section>
                    <h3>Распределение <code>calls_daily</code> (train)</h3>
                    <table>
                        <thead><tr><th>Показатель</th><th>Значение</th></tr></thead>
                        <tbody>
                            <tr><td>Число наблюдений</td><td>13 699</td></tr>
                            <tr><td>Среднее</td><td>0,422</td></tr>
                            <tr><td>Ст. отклонение</td><td>1,506</td></tr>
                            <tr><td>min</td><td>≈ 0</td></tr>
                            <tr><td>Q₁</td><td>0,0156</td></tr>
                            <tr><td>Медиана (Q₂)</td><td>0,0464</td></tr>
                            <tr><td>Q₃</td><td>0,2126</td></tr>
                            <tr><td>max</td><td>77,403</td></tr>
                        </tbody>
                    </table>
                    <p class="fragment" style="margin-top: 0.5em;"> <span class="accent">сильная правосторонняя асимметрия:</span> среднее > медианы, «горячие» квадраты (25%) дают <strong>92%</strong> вызовов</p>
                </section>
          
                <section>
    <h3>Гистограмма распределения calls_daily</h3>
    <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 800px; max-height: 50vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data2.png" alt="Гистограмма распределения вызовов" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
    <p class="figcaption" style="margin-top: 0.2rem; text-align: center;">Рис. 2 – Гистограмма calls_daily (логарифмическая шкала частот)</p>
</section>

            <!-- ============================================== -->
            <!-- 4. Будни / выходные                             -->
            <!-- ============================================== -->

                <section>
                    <h3>Будни vs выходные</h3>
                    <table>
                        <thead><tr><th>Показатель</th><th>calls_workday</th><th>calls_weekend</th></tr></thead>
                        <tbody>
                            <tr><td>Среднее</td><td>0,4279</td><td>0,4085</td></tr>
                            <tr><td>Ст.откл.</td><td>1,4631</td><td>1,6374</td></tr>
                            <tr><td>Q₁</td><td>0,0143</td><td>0,0172</td></tr>
                            <tr><td>Медиана</td><td>0,0445</td><td>0,0487</td></tr>
                            <tr><td>Q₃</td><td>0,2130</td><td>0,2129</td></tr>
                            <tr><td>max</td><td>72,93</td><td>90,90</td></tr>
                        </tbody>
                    </table>
                    <p class="fragment"><span class="accent">57,3%</span> квадратов активнее в выходные, разброс выше в выходные</p>
                </section>
                
                     <section>
                        <h3>Будни vs выходные</h3>
                            <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 800px; max-height: 50vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data3.png" alt="Гистограмма распределения вызовов" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
    <p class="figcaption" style="margin-top: 0.2rem; text-align: center;">Рис. 3 – Сравнение нагрузки в будни и выходные: calls_workday vs calls_weekend. Диагональ $y=x$</p>
                </section>

            <!-- ============================================== -->
            <!-- 5. Дни недели                                    -->
            <!-- ============================================== -->
          
                <section>
                    <h3>Средние по дням недели</h3>
                    <table>
                        <thead><tr><th>День</th><th>Ср.</th><th>Ст.откл.</th></tr></thead>
                        <tbody>
                            <tr><td>Пн</td><td>0,429</td><td>1,42</td></tr>
                            <tr><td>Вт</td><td>0,423</td><td>1,45</td></tr>
                            <tr><td>Ср</td><td>0,427</td><td>1,46</td></tr>
                            <tr><td>Чт</td><td>0,424</td><td>1,51</td></tr>
                            <tr><td>Пт</td><td>0,437</td><td>1,57</td></tr>
                            <tr><td>Сб</td><td>0,427</td><td>1,71</td></tr>
                            <tr><td>Вс</td><td>0,396</td><td>1,58</td></tr>
                        </tbody>
                    </table>
                    <p>минимум в воскресенье, пик в пятницу, дисперсия ↑ к выходным</p>
                </section>
         
             
                            <section>
    <h3>Средние по дням недели</h3>
    <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 800px; max-height: 50vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data4.png" alt="Столбчатая диаграмма среднего числа вызовов по дням недели" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
    <p class="figcaption" style="margin-top: 0.2rem; text-align: center;">Рис. 4 – Среднее число вызовов по дням недели</p>
</section>

            <!-- ============================================== -->
            <!-- 6. Пространственный тренд и карта               -->
            <!-- ============================================== -->
                <section>
                    <h3> Пространственный тренд</h3>
                    <p>Корреляция calls_daily с долготой: <span class="accent">+0,28</span> (рост с запада на восток)</p>
                   <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 900px; max-height: 55vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data5.png" alt="Столбчатая диаграмма среднего числа вызовов по дням недели" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
      <p class="figcaption" style="margin-top: 0.5rem; text-align: center;">Рис. 5 – Cреднее число вызовов в день в зависимости от долготы </p>
                </section>
            
                <section>
    <h3 style="text-align: center;">Карта интенсивности </h3>
    <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
    <div style="width: 80%; max-width: 900px; max-height: 48vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
        <img src="data6.png" alt="Карта интенсивности вызовов (train)" style="width: 100%; height: auto; display: block;">
    </div>
</div>
    <p class="figcaption" style="margin-top: 0.5rem; text-align: center;">Рис. 6 – $\;log(1+calls\_daily)$ на территории train </p>
</section>
                </section>

            <!-- ============================================== -->
            <!-- 7. Признаки – геометрические                    -->
            <!-- ============================================== -->
            <section>
      <section>
    <h3>Признак: расстояние до центра</h3>
    <div class="card" style="margin-bottom: 1rem; text-align: left;">
        <p> Расстояние от центра квадрата \((lat_c, lon_c)\) до <strong>условного центра области</strong> \((lat_0, lon_0)\) – средних координат всех квадратов.</p>
        <p style="margin-top: 0.8rem;"><strong>Формула гаверсинуса</strong> (радиус \(R = 6371\) км):</p>
<div style="background: #ffffff; padding: 1rem; border-radius: 12px; margin: 0.8rem 0; text-align: center; font-size: 1.5rem;">
    $$
    \text{dist} = 2R \cdot \arcsin\left( \sqrt{ \sin^2\left(\frac{lat_0 - lat_c}{2}\right) + \cos(lat_c)\cos(lat_0)\sin^2\left(\frac{lon_0 - lon_c}{2}\right) } \right)
    $$
</div>
        <p><strong>Связь с целевой переменной:</strong> коэффициент корреляции Пирсона с <code>calls_daily</code> равен <span class="accent">-0,315</span> — умеренная отрицательная связь. Чем дальше от центра, тем в среднем меньше вызовов.</p>
    </div>
 
</section>
    <section>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
        <div class="card" style="text-align: center;">
            <div class="card-title">Статистика признака</div>
            <p>среднее: 8,4 км<br>ст. отклонение: 4,1 км<br>мин: 0,2 км<br>макс: 19,7 км</p>
        </div>
        <div class="card" style="text-align: center; ">
            <div class="card-title">Интерпретация</div>
            <p>При удалении на 1 км от центра ожидаемое число вызовов снижается примерно на 0,03 (в лог-шкале).</p>
        </div>
    </div>
    </section>
</section>
            <!-- ============================================== -->
<!-- Кластеризация территории (k-means, geo-only)   -->
<!-- ============================================== -->
<section>
    <!-- Слайд 1: Идея и метод -->
    <section>
        <h3>Кластеризация территории</h3>
        <div class="card" style="margin-bottom: 1.5rem;">
            <div class="card-title">Смысл</div>
            <p>Интенсивность вызовов зависит от местоположения. Чтобы учесть принадлежность к крупным городским зонам, мы сгруппировали квадраты по координатам центров.</p>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="card">
                <div class="card-title" style="max-height: 5vh">Метод</div>
                <p>Алгоритм <strong>k‑means</strong> (\(k=10\)) обучен только на координатах (<code>lat_c</code>, <code>lon_c</code>) обучающей выборки. Полученные центроиды применены ко всем зонам.</p>
            </div>
            <div class="card">
                <div class="card-title">Результат</div>
                <p>Каждая зона получила метку кластера <code>cluster_geo_k10</code> и набор признаков, описывающих её положение относительно центроидов.</p>
            </div>
        </div>
    </section>

    <!-- Слайд 2: Полученные признаки -->
<section>
    <h3>Признаки на основе кластеризации</h3>
    <table style="width:100%; font-size:0.7em; margin-top:1rem;">
        <thead>
            <tr><th>Признак</th><th>Описание</th></tr>
        </thead>
        <tbody>
            <tr><td><code>cluster_geo_k10</code></td><td>Идентификатор географического кластера (k-means, k=10)</td></tr>
            <tr><td><code>k10_dist_to_own_centroid</code></td><td>Расстояние от зоны до центроида своего кластера</td></tr>
            <tr><td><code>k10_dist_to_centroid_0 … _9</code></td><td>Расстояния до всех десяти центроидов (позиционный профиль)</td></tr>
            <tr><td><code>k10_cluster_size</code></td><td>Количество зон в кластере</td></tr>
            <tr><td><code>k10_cluster_lat_mean</code>, <code>k10_cluster_lon_mean</code></td><td>Средние координаты кластера</td></tr>
            <tr><td><code>k10_cluster_radius_mean</code></td><td>Среднее расстояние от точек кластера до его центроида (условный радиус)</td></tr>
        </tbody>
    </table>
    <p class="figcaption" style="margin-top:1rem;">Эти признаки позволяют модели учитывать «районную» принадлежность и локальную геометрию.</p>
</section>

    <!-- Слайд 3: Визуализация кластеров -->
    <section>
        <h3> Карта кластеров (k-means, k=10)</h3>
        
            <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 800px; max-height: 50vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data7.png" alt="Гистограмма распределения вызовов" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
    
    
        <p style="font-size:0.8rem;">Границы имеют геометрический характер и не совпадают с административными районами – это техническое разбиение для анализа.</p>
    </section>

    <!-- Слайд 4: Таблица характеристик кластеров -->
    <section>
        <h3> Характеристики кластеров</h3>
        <table style="font-size:0.55em;">
            <thead>
                <tr><th>cluster</th><th>count</th><th>средние (lat / lon)</th><th>диапазон (lat / lon)</th></tr>
            </thead>
            <tbody>
                <tr><td>0</td><td>1492</td><td>55.717 / 37.014</td><td>55.605–55.830 / 36.894–37.150</td></tr>
                <tr><td>1</td><td>4215</td><td>55.954 / 37.728</td><td>55.843–56.064 / 37.372–38.070</td></tr>
                <tr><td>2</td><td>4411</td><td>55.497 / 37.734</td><td>55.380–55.619 / 37.381–38.070</td></tr>
                <tr><td>3</td><td>1145</td><td>55.987 / 37.259</td><td>55.902–56.064 / 37.123–37.396</td></tr>
                <tr><td>4</td><td>1119</td><td>55.462 / 37.270</td><td>55.381–55.548 / 37.137–37.405</td></tr>
                <tr><td>5</td><td>4279</td><td>55.729 / 37.727</td><td>55.615–55.843 / 37.373–38.067</td></tr>
                <tr><td>6</td><td>1257</td><td>55.817 / 37.255</td><td>55.722–55.902 / 37.109–37.404</td></tr>
                <tr><td>7</td><td>1513</td><td>55.949 / 37.012</td><td>55.834–56.064 / 36.893–37.140</td></tr>
                <tr><td>8</td><td>1489</td><td>55.492 / 37.022</td><td>55.380–55.605 / 36.897–37.152</td></tr>
                <tr><td>9</td><td>1252</td><td>55.636 / 37.266</td><td>55.552–55.732 / 37.119–37.413</td></tr>
            </tbody>
        </table>
        <p style="margin-top:1rem;"> <span class="accent">Восточные кластеры</span> (1,2,5) имеют бóльшую долготу (\(>37.7\)), западные – меньшую. Алгоритм отражает географический градиент запад–восток.</p>
    </section>
</section>


 
    <!-- ============================================== -->
<!-- Признаки на основе диаграммы Вороного          -->
<!-- ============================================== -->
<section>
    <!-- ============================================== -->
<!-- Диаграмма Вороного: текстовое описание         -->
<!-- ============================================== -->
<section>
    <section>
        <h3> Диаграмма Вороного: определение</h3>
        <div class="card" style="margin: 1rem 0; text-align: left;">
            <p><strong>Диаграмма Вороного</strong> — это разбиение плоскости на области, каждая из которых состоит из всех точек, более близких к своему «генератору» (центру квадрата), чем к любому другому.</p>
            <p style="margin-top: 0.8rem;">Генераторами выступают центры всех квадратов. Получается мозаика из многоугольников, покрывающая всю территорию без пропусков и наложений. Границы между областями проходят строго посередине между соседними генераторами.</p>
        </div>
        <div class="card" style="margin: 1rem 0; text-align: left;">
            <p><strong>Соседство по Вороному:</strong> два квадрата считаются соседями, если их области имеют общую границу (отрезок или луч). Это естественное определение соседства, не зависящее от регулярности исходной сетки.</p>
        </div>
    </section>
</section>

  <section>
  <div style="display: flex; justify-content: center; margin: 0.5rem 0;">
        <div style="width: 80%; max-width: 800px; max-height: 50vh; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden;">
            <img src="data9.png" alt="Столбчатая диаграмма среднего числа вызовов по дням недели" style="width: 100%; height: auto; display: block;">
        </div>
    </div>
  </section>
    <!-- Слайд 2: Полученные признаки -->
    <section>
        <h3> Признаки на основе Вороного</h3>
        <table style="width:100%; font-size:0.7em; margin-top:1rem;">
            <thead>
                <tr><th>Признак</th><th>Описание</th></tr>
            </thead>
            <tbody>
                <tr><td><code>vor_n_neighbors</code></td><td>Количество соседей по Вороному</td></tr>
                <tr><td><code>vor_is_outlier_neighbors</code></td><td>Индикатор выброса (1 если число соседей аномально)</td></tr>
                <tr><td><code>vor_n_neighbors_log</code></td><td>Логарифм числа соседей: \(\log(1 + \text{vor\_n\_neighbors})\)</td></tr>
                <tr><td><code>vor_max_dist_clip</code></td><td>Максимальное расстояние до соседей (клиппированное)</td></tr>
                <tr><td><code>vor_mean_dist_clip</code></td><td>Среднее расстояние до соседей (клиппированное)</td></tr>
            </tbody>
        </table>
        <div class="card" style="margin-top:1rem; font-size:0.8rem;">
            <p><strong>Зачем логарифмирование и клиппинг?</strong> Для стабилизации распределения и уменьшения влияния редких выбросов (например, на границе покрытия).</p>
        </div>
    </section>

    <!-- Слайд 3: Статистики признаков -->
    <section>
        <h3> Статистики признаков Вороного</h3>
        <table style="font-size:0.55em; width:100%;">
            <thead>
                <tr><th>Признак</th><th>count</th><th>mean</th><th>std</th><th>min</th><th>25%</th><th>50%</th><th>75%</th><th>max</th></tr>
            </thead>
            <tbody>
                <tr><td><code>vor_n_neighbors</code></td><td>22172</td><td>5.99</td><td>0.95</td><td>3</td><td>6</td><td>6</td><td>6</td><td>115</td></tr>
                <tr><td><code>vor_is_outlier_neighbors</code></td><td>22172</td><td>0.004</td><td>0.065</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr>
                <tr><td><code>vor_n_neighbors_log</code></td><td>22172</td><td>1.94</td><td>0.06</td><td>1.39</td><td>1.95</td><td>1.95</td><td>1.95</td><td>4.75</td></tr>
                <tr><td><code>vor_max_dist_clip</code></td><td>22172</td><td>0.01096</td><td>0.01794</td><td>0.0079</td><td>0.0091</td><td>0.0091</td><td>0.0092</td><td>0.2336</td></tr>
                <tr><td><code>vor_mean_dist_clip</code></td><td>22172</td><td>0.00756</td><td>0.00336</td><td>0.0056</td><td>0.0072</td><td>0.0072</td><td>0.0072</td><td>0.0484</td></tr>
            </tbody>
        </table>
        <p style="margin-top:1rem;">Большинство зон имеют 6 соседей (регулярная сетка). Выбросы (до 115 соседей) возникают на границах или из‑за «дыр» в данных. Логарифмирование сглаживает такие аномалии.</p>
    </section>
</section>
                <!-- ============================================== -->
<!-- Признаки городской среды (OpenStreetMap)       -->
<!-- ============================================== -->
<section>
    <!-- Слайд 1: Идея и источник -->
    <section>
        <h3>Признаки городской среды (OSM)</h3>
        <div class="card" style="margin-bottom:1rem;">
            <div class="card-title">Зачем?</div>
            <p>Квадраты со схожим географическим положением могут сильно различаться по нагрузке из‑за разной инфраструктуры. Данные OpenStreetMap позволяют учесть концентрацию «точек притяжения» людей.</p>
        </div>
        <div class="card">
            <div class="card-title">Источник</div>
            <p>Файл формата <code>.osm.pbf</code> по Москве. Извлечены точки интереса (POI) на основе тегов OSM.</p>
        </div>
    </section>

    <!-- Слайд 2: Категории объектов -->
    <section>
        <h3> Категории объектов OSM</h3>
        <table style="width:100%; font-size:0.7em;">
            <thead><tr><th>Категория</th><th>Теги OSM (примеры)</th></tr></thead>
            <tbody>
                <tr><td><code>med</code></td><td><code>amenity=hospital, clinic, doctors, pharmacy</code></td></tr>
                <tr><td><code>edu</code></td><td><code>amenity=school, kindergarten, university</code></td></tr>
                <tr><td><code>safety</code></td><td><code>amenity=police, fire_station</code></td></tr>
                <tr><td><code>food</code></td><td><code>amenity=restaurant, cafe, bar, fast_food</code></td></tr>
                <tr><td><code>transport</code></td><td><code>railway=station, subway_entrance, highway=bus_stop, public_transport=platform, stop_position</code></td></tr>
                <tr><td><code>shop</code></td><td><code>shop=*</code> (любые магазины)</td></tr>
            </tbody>
        </table>
        <p class="figcaption" style="margin-top:0.5rem;">Для каждой категории подсчитывалось количество объектов в окрестности квадрата.</p>
    </section>

<!-- ============================================== -->
<!-- Слайд 3a: Алгоритм и радиусы поиска            -->
<!-- ============================================== -->
<section>
    <h3>Метод подсчёта признаков OSM </h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="card">
            <div class="card-title">Алгоритм: BallTree</div>
            <p>Структура данных для быстрого поиска ближайших соседей в многомерном пространстве. Используется с метрикой haversine, что позволяет эффективно находить все точки POI в заданном радиусе от центра квадрата.</p>
            <p style="margin-top:0.5rem;"><span class="accent">Сложность:</span> \(O(\log N)\) на запрос вместо \(O(N)\) полного перебора.</p>
        </div>
        <div class="card">
            <div class="card-title">Радиусы поиска</div>
            <p>Для каждой категории построены признаки для двух радиусов:</p>
            <ul style="margin:0;">
                <li>500 м – пешеходная доступность</li>
                <li>1000 м – районный уровень</li>
            </ul>
            <p style="margin-top:0.5rem;">Такой выбор охватывает локальное окружение квадрата и ближайшие значимые объекты.</p>
        </div>
    </div>
    <p style="margin-top:1rem; font-size:0.8rem;">Для каждого квадрата и каждой категории POI выполняется запрос к BallTree, подсчитывается количество объектов в пределах заданного радиуса, результат сохраняется как признак (например, <code>osm_med_count_r500</code>).</p>
</section>

<!-- ============================================== -->
<!-- Слайд 3b: Метрика haversine (формула)          -->
<!-- ============================================== -->
<section>
    <h3>Метод подсчёта признаков OSM </h3>
    <div class="card">
        <div class="card-title">Метрика haversine</div>
        <p>Вычисляет расстояние между двумя точками на сфере по их широте и долготе. Необходима, потому что евклидово расстояние в градусах не соответствует реальным километрам (длина градуса долготы зависит от широты).</p>
        <div style="background: #ffffff; padding: 0.8rem; border-radius: 12px; text-align: center; font-size: 1.5rem; margin-top: 1.5rem;">
            $$
            \begin{aligned}
            &\Delta \text{lat} = \text{lat}_2 - \text{lat}_1,\quad \Delta \text{lon} = \text{lon}_2 - \text{lon}_1 \\[0.3em]
            &a = \sin^2\left(\frac{\Delta \text{lat}}{2}\right) + \cos(\text{lat}_1)\cos(\text{lat}_2)\sin^2\left(\frac{\Delta \text{lon}}{2}\right) \\[0.3em]
            &d = 2R \cdot \arctan2\left(\sqrt{a}, \sqrt{1-a}\right),\quad R = 6371\ \text{км}
            \end{aligned}
            $$
        </div>
        <p style="margin-top:0.8rem;">В проекте расстояние вычисляется в метрах (\(R = 6371000\) м) для работы с радиусами 500 и 1000 м. Метрика haversine встроена в BallTree и применяется автоматически при каждом запросе.</p>
    </div>
    <p style="margin-top:1rem; font-size:0.8rem;">Использование корректной метрики гарантирует, что в радиус 500 м попадут именно те объекты, которые действительно находятся в пределах 500 м по поверхности Земли, а не по прямой в градусной мере.</p>
</section>

    <!-- Слайд 4: Итоговые признаки -->
    <section>
        <h3> Итоговые признаки OSM</h3>
        <table style="width:100%; font-size:0.7em;">
            <thead><tr><th>Признак</th><th>Описание</th></tr></thead>
            <tbody>
                <tr><td><code>osm_med_count_r500</code></td><td>количество медицинских объектов в радиусе 500 м</td></tr>
                <tr><td><code>osm_med_count_r1000</code></td><td>то же, радиус 1000 м</td></tr>
                <tr><td><code>osm_edu_count_r500</code></td><td>образовательные объекты, 500 м</td></tr>
                <tr><td><code>osm_edu_count_r1000</code></td><td>образовательные объекты, 1000 м</td></tr>
                <tr><td><code>osm_safety_count_r500</code></td><td>объекты безопасности, 500 м</td></tr>
                <tr><td><code>osm_safety_count_r1000</code></td><td>объекты безопасности, 1000 м</td></tr>
                <tr><td><code>osm_food_count_r500</code></td><td>общепит, 500 м</td></tr>
                <tr><td><code>osm_food_count_r1000</code></td><td>общепит, 1000 м</td></tr>
                <tr><td><code>osm_transport_count_r500</code></td><td>транспортные объекты, 500 м</td></tr>
                <tr><td><code>osm_transport_count_r1000</code></td><td>транспортные объекты, 1000 м</td></tr>
                <tr><td><code>osm_shop_count_r500</code></td><td>магазины, 500 м</td></tr>
                <tr><td><code>osm_shop_count_r1000</code></td><td>магазины, 1000 м</td></tr>
            </tbody>
        </table>
        <p style="margin-top:0.5rem; font-size:0.75rem;">Всего 12 новых признаков (6 категорий × 2 радиуса).</p>
    </section>
</section>

            <!-- ============================================== -->
            <!-- 9. Модель – метрика, валидация, сравнение       -->
            <!-- ============================================== -->

        <section>
    <h2 style="text-align: center; margin-bottom: 1rem;">Целевая метрика и валидация</h2>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
        <!-- Карточка 1: Целевая переменная -->
        <div class="card" style="padding: 1.2rem;">
            <div class="card-title" style="font-size: 1.2rem;">
             Целевая переменная
            </div>
            <p style="font-size: 1rem; margin: 0.5rem 0;">\( y = \log(1 + \text{calls\_daily}) \)</p>
            <p style="font-size: 0.9rem; line-height: 1.4;">Логарифмическое преобразование применено из-за сильной правосторонней асимметрии распределения <code>calls_daily</code>. Оно делает распределение более симметричным, приближая его к нормальному, что повышает устойчивость моделей.</p>
        </div>
        <!-- Карточка 2: Метрика -->
        <div class="card" style="padding: 1.2rem;">
            <div class="card-title" style="font-size: 1.2rem;">
            Метрика
            </div>
            <p style="font-size: 1rem; margin: 0.5rem 0;"><strong>RMSE</strong> в лог-шкале</p>
            <p style="font-size: 0.9rem; line-height: 1.4;">Ошибка измеряется на преобразованном таргете, чтобы избежать доминирования редких высоких значений. <strong>Baseline</strong> (предсказание среднего по обучающей выборке) составляет <span class="accent">0,406</span>. Все модели сравниваются с этим уровнем.</p>
        </div>
    </div>
    <!-- Карточка 3: Валидация (на всю ширину) -->
    <div class="card" style="padding: 1.2rem;">
        <div class="card-title" style="font-size: 1.2rem;">
        Валидация (GroupKFold)
        </div>
        <p style="font-size: 0.95rem; line-height: 1.5;">Обычная случайная разбивка (KFold) неприменима из-за <strong>пространственной автокорреляции</strong>: близкие квадраты статистически похожи. Если они попадут и в обучающую, и в тестовую выборки, модель «подсмотрит» соседей, и оценка качества будет завышенной.</p>
        <p style="font-size: 0.95rem; line-height: 1.5; margin-top: 0.5rem;">Используется <span class="accent">GroupKFold (5 фолдов)</span> – разбиение по географическим кластерам (<code>cluster_geo_k10</code>). Целые кластеры уходят в тест, что имитирует применение модели на новых, незнакомых районах и даёт честную оценку обобщающей способности.</p>
    </div>
</section>
               
                <section>
                    <h3>Сравнение моделей (RMSE log1p)</h3>
                    <table>
                        <thead><tr><th>Модель</th><th>RMSE</th></tr></thead>
                        <tbody>
                            <tr><td>Ridge/Lasso/ElasticNet</td><td>~0,236</td></tr>
                            <tr><td>RandomForest</td><td>0,242</td></tr>
                            <tr><td>ExtraTrees</td><td><span class="accent">0,233</span></td></tr>
                            <tr><td>GradientBoosting</td><td>~0,240</td></tr>
                            <tr><td>HistGradientBoosting</td><td>0,240</td></tr>
                        </tbody>
                    </table>
                </section>

                <section>
                    <h3> Тюнинг и ансамбль</h3>
                    <ul>
                        <li>ExtraTrees (max_features=0.7, min_samples_leaf=2) → 0,2322</li>
                        <li>Lasso (α=0,00215) → 0,2344</li>
                        <li class="fragment"><span class="accent">Ансамбль (0,59 ET + 0,41 Lasso) → 0,2301</span> (улучшение baseline на 43%)</li>
                    </ul>
                </section>

                <section>
                    <h3> Финальный прогноз (test)</h3>
                    <table>
                        <tr><th>Показатель</th><th>значение</th></tr>
                        <tr><td>медиана</td><td>0,036 вызовов/день</td></tr>
                        <tr><td>75% квантиль</td><td>0,126</td></tr>
                        <tr><td>максимум</td><td>11,3</td></tr>
                    </table>
                    <p>Распределение адекватно, структура сохранена.</p>
                </section>
            </section>

            <!-- ============================================== -->
            <!-- 10. Заключение                                  -->
            <!-- ============================================== -->
            <section>
                <h2>Заключение</h2>
                <div class="card">
                    <ul>
                        <li>Выявлена крайне неравномерная нагрузка (92% вызовов в 25% квадратов)</li>
                        <li>Построен  набор признаков: геометрия, кластеры, Вороного, POI из OSM</li>
                        <li>Лучшая модель – ансамбль ExtraTrees + Lasso (RMSE=0,2301)</li>
                        <li>Пространственная валидация (GroupKFold) обеспечила честную оценку</li>
                        <li>Результаты применимы для планирования ресурсов экстренных служб</li>
                    </ul>
                </div>
            </section>

            <!-- ============================================== -->
            <!-- 11. Литература и благодарности                  -->
            <!-- ============================================== -->
            <section>
                <section>
                    <h2> Литература</h2>
                    <div class="two-columns small">
                        <ul>
                            <li>Aurenhammer F. Voronoi diagrams – a survey // ACM Comput. Surv. 1991.</li>
                            <li>Bivand R. et al. Applied Spatial Data Analysis with R. 2013.</li>
                            <li>Breiman L. Random Forests // MLJ. 2001.</li>
                            <li>Geurts P. et al. Extremely randomized trees // MLJ. 2006.</li>
                        </ul>
                        <ul>
                            <li>Hastie T. et al. The Elements of Statistical Learning. 2009.</li>
                            <li>James G. et al. An Introduction to Statistical Learning. 2013.</li>
                            <li>Pedregosa F. et al. Scikit-learn: ML in Python // JMLR. 2011.</li>
                            <li>OpenStreetMap contributors. planet.osm.org.</li>
                        </ul>
                    </div>
                </section>
            </section>
        </div> <!-- slides -->
    </div> <!-- reveal -->

    <!-- скрипты -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.4.0/reveal.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            backgroundTransition: 'fade',
            controls: true,
            progress: true,
            center: true,
            width: 1200,
            height: 700,
            margin: 0.04,
            minScale: 0.2,
            maxScale: 2.0,
            plugins: []
        });

        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '\\(', right: '\\)', display: false},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });
    </script>
    <style>
        .reveal .slides { text-align: left; }
        .reveal section { text-align: left; }
        .reveal h1, .reveal h2, .reveal h3 { text-align: center; }
        .reveal ul { display: block; }
        .reveal .card ul { margin-left: 1em; }
        .reveal table { margin-left: auto; margin-right: auto; }
        .reveal .svg-placeholder svg { background: #ffffff; }
    </style>
</body>
</html>